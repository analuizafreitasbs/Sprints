SELECT 
    NOSERVIDOR,
    NUCPF,
    NOCARGOEMPREGO,
    NOORGAO,
    UFUPAG,
    NOCIDADERESIDENCIA,
    NIVELESCOLARIDADE,
    ANOMESINICIALAFAST,
    ANOMESREFAFAST,
    VARENDIMENTOLIQUIDO,
    NOAFASTAMENTO,
    SUM(CAST(VARENDIMENTOLIQUIDO AS FLOAT)) OVER() AS soma_rendimentos,
    AVG(CAST(VARENDIMENTOLIQUIDO AS FLOAT)) OVER() AS media_rendimentos,
    CASE 
        WHEN CAST(VARENDIMENTOLIQUIDO AS FLOAT) > 5000 THEN 'ALTO'
        ELSE 'BAIXO'
    END AS categoria_rendimento,
    COUNT(*) OVER() AS total_meses
FROM  S3Object
WHERE NOCARGOEMPREGO = 'TECNICO DE CONTABILIDADE'
  AND NOORGAO = 'MINISTDA AGRICULTURA,PECUARIA E ABAST'
LIMIT 10
